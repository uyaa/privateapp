<?php

$json = '{ "id": 4585795280, "email": "info@studiorao.nl", "closed_at": null, "created_at": "2017-04-25T13:08:13-04:00", "updated_at": "2017-04-25T13:08:13-04:00", "number": 3, "note": null, "token": "10d81019c1dd924350c429ca26506de7", "gateway": "bogus", "test": true, "total_price": "681.55", "subtotal_price": "555.00", "total_weight": 0, "total_tax": "116.55", "taxes_included": false, "currency": "EUR", "financial_status": "authorized", "confirmed": true, "total_discounts": "0.00", "total_line_items_price": "555.00", "cart_token": "868506a384e340b77cc9db9aa6254b09", "buyer_accepts_marketing": false, "name": "#1003", "referring_site": "", "landing_site": "/password", "cancelled_at": null, "cancel_reason": null, "total_price_usd": "740.48", "checkout_token": "826cc8b1ab805666064d943b11859da7", "reference": null, "user_id": null, "location_id": null, "source_identifier": null, "source_url": null, "processed_at": "2017-04-25T13:08:13-04:00", "device_id": null, "phone": null, "browser_ip": "201.202.125.58", "landing_site_ref": null, "order_number": 1003, "discount_codes": [], "note_attributes": [], "payment_gateway_names": [ "bogus" ], "processing_method": "direct", "checkout_id": 13421943696, "source_name": "web", "fulfillment_status": null, "tax_lines": [{ "title": "VAT", "price": "116.55", "rate": 0.21 }], "tags": "", "contact_email": "info@studiorao.nl", "order_status_url": "https://checkout.shopify.com/19038531/checkouts/826cc8b1ab805666064d943b11859da7/thank_you_token?key=b4613e6bb5044780761b99817f6ae569", "line_items": [{ "id": 8563409808, "variant_id": 33870795280, "title": "Vertical Grid Profiles", "quantity": 1, "price": "0.00", "grams": 0, "sku": "", "variant_title": "0", "vendor": "Portapivot", "fulfillment_service": "manual", "product_id": 8713150160, "requires_shipping": true, "taxable": true, "gift_card": false, "name": "Vertical Grid Profiles - 0", "variant_inventory_management": null, "properties": [{ "name": "Height", "value": "2270" }, { "name": "Width", "value": "1290" }, { "name": "Color", "value": "bronze" }, { "name": "hingePosition", "value": "" }, { "name": "referenceNumber", "value": "jan_01" } ], "product_exists": true, "fulfillable_quantity": 1, "total_discount": "0.00", "fulfillment_status": null, "tax_lines": [{ "title": "VAT", "price": "0.00", "rate": 0.21 }], "origin_location": { "id": 3136684496, "country_code": "NL", "province_code": "", "name": "portatest", "address1": "Pannekoekstraat 37 a", "address2": "", "city": "Rotterdam", "zip": "3011 LC" }, "destination_location": { "id": 3136685264, "country_code": "NL", "province_code": "", "name": "A Overbosch-Brunsting", "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "zip": "3311 DB" } }, { "id": 8563409872, "variant_id": 35645859856, "title": "Horizontal Grid Profiles", "quantity": 1, "price": "0.00", "grams": 0, "sku": "", "variant_title": "1 / 1500", "vendor": "Portapivot", "fulfillment_service": "manual", "product_id": 8713120912, "requires_shipping": true, "taxable": true, "gift_card": false, "name": "Horizontal Grid Profiles - 1 / 1500", "variant_inventory_management": null, "properties": [{ "name": "Height", "value": "2270" }, { "name": "Width", "value": "1290" }, { "name": "Color", "value": "bronze" }, { "name": "hingePosition", "value": "" }, { "name": "referenceNumber", "value": "jan_01" } ], "product_exists": true, "fulfillable_quantity": 1, "total_discount": "0.00", "fulfillment_status": null, "tax_lines": [{ "title": "VAT", "price": "0.00", "rate": 0.21 }], "origin_location": { "id": 3136684496, "country_code": "NL", "province_code": "", "name": "portatest", "address1": "Pannekoekstraat 37 a", "address2": "", "city": "Rotterdam", "zip": "3011 LC" }, "destination_location": { "id": 3136685264, "country_code": "NL", "province_code": "", "name": "A Overbosch-Brunsting", "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "zip": "3311 DB" } }, { "id": 8563409936, "variant_id": 33870792336, "title": "UGP", "quantity": 1, "price": "0.00", "grams": 0, "sku": "", "variant_title": "", "vendor": "Portapivot", "fulfillment_service": "manual", "product_id": 8713149648, "requires_shipping": true, "taxable": true, "gift_card": false, "name": "UGP", "variant_inventory_management": null, "properties": [{ "name": "Height", "value": "2270" }, { "name": "Width", "value": "1290" }, { "name": "Color", "value": "bronze" }, { "name": "hingePosition", "value": "" }, { "name": "referenceNumber", "value": "jan_01" } ], "product_exists": true, "fulfillable_quantity": 1, "total_discount": "0.00", "fulfillment_status": null, "tax_lines": [{ "title": "VAT", "price": "0.00", "rate": 0.21 }], "origin_location": { "id": 3136684496, "country_code": "NL", "province_code": "", "name": "portatest", "address1": "Pannekoekstraat 37 a", "address2": "", "city": "Rotterdam", "zip": "3011 LC" }, "destination_location": { "id": 3136685264, "country_code": "NL", "province_code": "", "name": "A Overbosch-Brunsting", "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "zip": "3311 DB" } }, { "id": 8563410000, "variant_id": 33870617040, "title": "PORTAPIVOT 6530 XL", "quantity": 1, "price": "555.00", "grams": 0, "sku": "", "variant_title": "2250 - 2500mm / 1200 - 1299mm / Basic set", "vendor": "Portapivot", "fulfillment_service": "manual", "product_id": 8713135440, "requires_shipping": true, "taxable": true, "gift_card": false, "name": "PORTAPIVOT 6530 XL - 2250 - 2500mm / 1200 - 1299mm", "variant_inventory_management": null, "properties": [{ "name": "Height", "value": "2270" }, { "name": "Width", "value": "1290" }, { "name": "Color", "value": "bronze" }, { "name": "hingePosition", "value": "" }, { "name": "referenceNumber", "value": "jan_01" } ], "product_exists": true, "fulfillable_quantity": 1, "total_discount": "0.00", "fulfillment_status": null, "tax_lines": [{ "title": "VAT", "price": "116.55", "rate": 0.21 }], "origin_location": { "id": 3136684496, "country_code": "NL", "province_code": "", "name": "portatest", "address1": "Pannekoekstraat 37 a", "address2": "", "city": "Rotterdam", "zip": "3011 LC" }, "destination_location": { "id": 3136685264, "country_code": "NL", "province_code": "", "name": "A Overbosch-Brunsting", "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "zip": "3311 DB" } } ], "shipping_lines": [{ "id": 3866102288, "title": "Standard Shipping", "price": "10.00", "code": "Standard Shipping", "source": "shopify", "phone": null, "requested_fulfillment_service_id": null, "delivery_category": null, "carrier_identifier": null, "tax_lines": [] }], "billing_address": { "first_name": "A", "address1": "Groenedijk", "phone": null, "city": "Dordrecht", "zip": "3311 DB", "province": null, "country": "Netherlands", "last_name": "Overbosch-Brunsting", "address2": "58", "company": null, "latitude": 51.8137503, "longitude": 4.680407499999999, "name": "A Overbosch-Brunsting", "country_code": "NL", "province_code": null }, "shipping_address": { "first_name": "A", "address1": "Groenedijk", "phone": null, "city": "Dordrecht", "zip": "3311 DB", "province": null, "country": "Netherlands", "last_name": "Overbosch-Brunsting", "address2": "58", "company": null, "latitude": 51.8137503, "longitude": 4.680407499999999, "name": "A Overbosch-Brunsting", "country_code": "NL", "province_code": null }, "fulfillments": [], "client_details": { "browser_ip": "201.202.125.58", "accept_language": "nl-NL,nl;q=0.8,en-US;q=0.6,en;q=0.4", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36", "session_hash": "11f6cc709c9ff5d80e561af058ff7f74", "browser_width": 1280, "browser_height": 699 }, "refunds": [], "payment_details": { "credit_card_bin": "1", "avs_result_code": null, "cvv_result_code": null, "credit_card_number": "•••• •••• •••• 1", "credit_card_company": "Bogus" }, "customer": { "id": 4992646480, "email": "info@studiorao.nl", "accepts_marketing": false, "created_at": "2017-04-05T15:09:27-04:00", "updated_at": "2017-04-25T13:08:13-04:00", "first_name": "A", "last_name": "Overbosch-Brunsting", "orders_count": 0, "state": "enabled", "total_spent": "0.00", "last_order_id": null, "note": "VAT Registration Number: NL1799 .87 .781.B01 ", "verified_email": true, "multipass_identifier": null, "tax_exempt": false, "phone": null, "tags": "", "last_order_name": null, "default_address": { "id": 5273097936, "first_name": "A", "last_name": "Overbosch-Brunsting", "company": null, "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "province": null, "country": "Netherlands", "zip": "3311 DB", "phone": null, "name": "A Overbosch-Brunsting", "province_code": null, "country_code": "NL", "country_name": "Netherlands", "default": true } } }';
$json = '{"id":820982911946154508,"email":"jon@doe.ca","closed_at":null,"created_at":"2017-05-16T10:01:00-04:00","updated_at":"2017-05-16T10:01:00-04:00","number":234,"note":null,"token":"123456abcd","gateway":null,"test":true,"total_price":"25.00","subtotal_price":"15.00","total_weight":0,"total_tax":"0.00","taxes_included":false,"currency":"USD","financial_status":"voided","confirmed":false,"total_discounts":"5.00","total_line_items_price":"20.00","cart_token":null,"buyer_accepts_marketing":true,"name":"#9999","referring_site":null,"landing_site":null,"cancelled_at":"2017-05-16T10:01:00-04:00","cancel_reason":"customer","total_price_usd":null,"checkout_token":null,"reference":null,"user_id":null,"location_id":null,"source_identifier":null,"source_url":null,"processed_at":null,"device_id":null,"phone":null,"browser_ip":null,"landing_site_ref":null,"order_number":1234,"discount_codes":[],"note_attributes":[],"payment_gateway_names":["visa","bogus"],"processing_method":"","checkout_id":null,"source_name":"web","fulfillment_status":"pending","tax_lines":[],"tags":"","contact_email":"jon@doe.ca","order_status_url":null,"line_items":[{"id":866550311766439020,"variant_id":null,"title":"Copy of Copy of Copy of PORTAPIVOT 6530 XL","quantity":1,"price":"20.00","grams":0,"sku":"","variant_title":null,"vendor":null,"fulfillment_service":"manual","product_id":8713102416,"requires_shipping":true,"taxable":true,"gift_card":false,"name":"Copy of Copy of Copy of PORTAPIVOT 6530 XL","variant_inventory_management":null,"properties":[],"product_exists":true,"fulfillable_quantity":1,"total_discount":"0.00","fulfillment_status":null,"tax_lines":[]},{"id":141249953214522974,"variant_id":null,"title":"Vertical Grid Profiles","quantity":1,"price":"0.00","grams":0,"sku":"","variant_title":null,"vendor":null,"fulfillment_service":"manual","product_id":8713150160,"requires_shipping":true,"taxable":true,"gift_card":false,"name":"Vertical Grid Profiles","variant_inventory_management":null,"properties":[],"product_exists":true,"fulfillable_quantity":1,"total_discount":"5.00","fulfillment_status":null,"tax_lines":[]}],"shipping_lines":[{"id":271878346596884015,"title":"Generic Shipping","price":"10.00","code":null,"source":"shopify","phone":null,"requested_fulfillment_service_id":null,"delivery_category":null,"carrier_identifier":null,"tax_lines":[]}],"billing_address":{"first_name":"Bob","address1":"123 Billing Street","phone":"555-555-BILL","city":"Billtown","zip":"K2P0B0","province":"Kentucky","country":"United States","last_name":"Biller","address2":null,"company":"My Company","latitude":null,"longitude":null,"name":"Bob Biller","country_code":"US","province_code":"KY"},"shipping_address":{"first_name":"Steve","address1":"123 Shipping Street","phone":"555-555-SHIP","city":"Shippington","zip":"K2P0S0","province":"Kentucky","country":"United States","last_name":"Shipper","address2":null,"company":"Shipping Company","latitude":null,"longitude":null,"name":"Steve Shipper","country_code":"US","province_code":"KY"},"fulfillments":[],"refunds":[],"customer":{"id":115310627314723954,"email":"john@test.com","accepts_marketing":false,"created_at":null,"updated_at":null,"first_name":"John","last_name":"Smith","orders_count":0,"state":"disabled","total_spent":"0.00","last_order_id":null,"note":null,"verified_email":true,"multipass_identifier":null,"tax_exempt":false,"phone":null,"tags":"","last_order_name":null,"default_address":{"id":715243470612851245,"first_name":null,"last_name":null,"company":null,"address1":"123 Elm St.","address2":null,"city":"Ottawa","province":"Ontario","country":"Canada","zip":"K2H7A8","phone":"123-123-1234","name":"","province_code":"ON","country_code":"CA","country_name":"Canada","default":false}}}';
$json = '{ "id": 4585795280, "email": "info@studiorao.nl", "closed_at": null, "created_at": "2017-04-25T13:08:13-04:00", "updated_at": "2017-04-25T13:08:13-04:00", "number": 3, "note": null, "token": "10d81019c1dd924350c429ca26506de7", "gateway": "bogus", "test": true, "total_price": "681.55", "subtotal_price": "555.00", "total_weight": 0, "total_tax": "116.55", "taxes_included": false, "currency": "EUR", "financial_status": "authorized", "confirmed": true, "total_discounts": "0.00", "total_line_items_price": "555.00", "cart_token": "868506a384e340b77cc9db9aa6254b09", "buyer_accepts_marketing": false, "name": "#1003", "referring_site": "", "landing_site": "/password", "cancelled_at": null, "cancel_reason": null, "total_price_usd": "740.48", "checkout_token": "826cc8b1ab805666064d943b11859da7", "reference": null, "user_id": null, "location_id": null, "source_identifier": null, "source_url": null, "processed_at": "2017-04-25T13:08:13-04:00", "device_id": null, "phone": null, "browser_ip": "201.202.125.58", "landing_site_ref": null, "order_number": 1003, "discount_codes": [ ], "note_attributes": [ ], "payment_gateway_names": [ "bogus" ], "processing_method": "direct", "checkout_id": 13421943696, "source_name": "web", "fulfillment_status": null, "tax_lines": [ { "title": "VAT", "price": "116.55", "rate": 0.21 } ], "tags": "", "contact_email": "info@studiorao.nl", "order_status_url": "https://checkout.shopify.com/19038531/checkouts/826cc8b1ab805666064d943b11859da7/thank_you_token?key=b4613e6bb5044780761b99817f6ae569", "line_items": [ { "id": 8725537872, "variant_id": 37441743952, "title": "Vertical Grid Profiles", "quantity": 1, "price": "0.00", "grams": 0, "sku": "", "variant_title": "0 / 0", "vendor": "Portapivot", "fulfillment_service": "manual", "product_id": 9368397392, "requires_shipping": true, "taxable": true, "gift_card": false, "name": "Vertical Grid Profiles - 0 / 0", "variant_inventory_management": null, "properties": [ { "name": "Height", "value": "2000" },{ "name": "Width", "value": "1200" },{ "name": "Color", "value": "black" },{ "name": "hingePosition", "value": "650" },{ "name": "referenceNumber", "value": "Home" } ], "product_exists": true, "fulfillable_quantity": 1, "total_discount": "0.00", "fulfillment_status": null, "tax_lines": [ ], "origin_location": { "id": 3136684496, "country_code": "NL", "province_code": "", "name": "portatest", "address1": "Pannekoekstraat 37 a", "address2": "", "city": "Rotterdam", "zip": "3011 LC" }, "destination_location": { "id": 3136685264, "country_code": "NL", "province_code": "", "name": "A Overbosch-Brunsting", "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "zip": "3311 DB" } },{ "id": 8725537936, "variant_id": 35645744912, "title": "Horizontal Grid Profiles", "quantity": 1, "price": "0.00", "grams": 0, "sku": "", "variant_title": "0 / 0", "vendor": "Portapivot", "fulfillment_service": "manual", "product_id": 8713120912, "requires_shipping": true, "taxable": true, "gift_card": false, "name": "Horizontal Grid Profiles - 0 / 0", "variant_inventory_management": null, "properties": [ { "name": "Height", "value": "2000" },{ "name": "Width", "value": "1200" },{ "name": "Color", "value": "black" },{ "name": "hingePosition", "value": "650" },{ "name": "referenceNumber", "value": "Home" } ], "product_exists": true, "fulfillable_quantity": 1, "total_discount": "0.00", "fulfillment_status": null, "tax_lines": [ ], "origin_location": { "id": 3136684496, "country_code": "NL", "province_code": "", "name": "portatest", "address1": "Pannekoekstraat 37 a", "address2": "", "city": "Rotterdam", "zip": "3011 LC" }, "destination_location": { "id": 3136685264, "country_code": "NL", "province_code": "", "name": "A Overbosch-Brunsting", "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "zip": "3311 DB" } },{ "id": 8725538000, "variant_id": 33870399184, "title": "single DG.10", "quantity": 1, "price": "287.50", "grams": 0, "sku": "", "variant_title": "", "vendor": "Portapivot", "fulfillment_service": "manual", "product_id": 8713114576, "requires_shipping": true, "taxable": true, "gift_card": false, "name": "single DG.10", "variant_inventory_management": null, "properties": [ { "name": "Height", "value": "2000" },{ "name": "Width", "value": "1200" },{ "name": "Color", "value": "black" },{ "name": "hingePosition", "value": "650" },{ "name": "referenceNumber", "value": "Home" } ], "product_exists": true, "fulfillable_quantity": 1, "total_discount": "0.00", "fulfillment_status": null, "tax_lines": [ ], "origin_location": { "id": 3136684496, "country_code": "NL", "province_code": "", "name": "portatest", "address1": "Pannekoekstraat 37 a", "address2": "", "city": "Rotterdam", "zip": "3011 LC" }, "destination_location": { "id": 3136685264, "country_code": "NL", "province_code": "", "name": "A Overbosch-Brunsting", "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "zip": "3311 DB" } },{ "id": 8725538064, "variant_id": 37445404304, "title": "PORTAPIVOT 6530 XL 02", "quantity": 1, "price": "445.00", "grams": 0, "sku": "", "variant_title": "2000 - 2250mm / 1200 - 1299mm / Basic set", "vendor": "Portapivot", "fulfillment_service": "manual", "product_id": 9368951696, "requires_shipping": true, "taxable": true, "gift_card": false, "name": "PORTAPIVOT 6530 XL 02 - 2000 - 2250mm / 1200 - 1299mm / Basic set", "variant_inventory_management": null, "properties": [ { "name": "Height", "value": "2000" },{ "name": "Width", "value": "1200" },{ "name": "Color", "value": "black" },{ "name": "hingePosition", "value": "650" },{ "name": "referenceNumber", "value": "Home" } ], "product_exists": true, "fulfillable_quantity": 1, "total_discount": "0.00", "fulfillment_status": null, "tax_lines": [ ], "origin_location": { "id": 3136684496, "country_code": "NL", "province_code": "", "name": "portatest", "address1": "Pannekoekstraat 37 a", "address2": "", "city": "Rotterdam", "zip": "3011 LC" }, "destination_location": { "id": 3136685264, "country_code": "NL", "province_code": "", "name": "A Overbosch-Brunsting", "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "zip": "3311 DB" }},{ "id": 8725537808, "variant_id": 37445715856, "title": "Copy of Stealth Pivot", "quantity": 4, "price": "295.00", "grams": 0, "sku": "Stealth Pivot", "variant_title": "", "vendor": "Portapivot", "fulfillment_service": "manual", "product_id": 9369004624, "requires_shipping": true, "taxable": true, "gift_card": false, "name": "Copy of Stealth Pivot", "variant_inventory_management": null, "properties": [ { "name": "Height", "value": "" },{ "name": "Width", "value": "" } ], "product_exists": true, "fulfillable_quantity": 4, "total_discount": "0.00", "fulfillment_status": null, "tax_lines": [ ], "origin_location": { "id": 3136684496, "country_code": "NL", "province_code": "", "name": "portatest", "address1": "Pannekoekstraat 37 a", "address2": "", "city": "Rotterdam", "zip": "3011 LC" }, "destination_location": { "id": 3136685264, "country_code": "NL", "province_code": "", "name": "A Overbosch-Brunsting", "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "zip": "3311 DB" }} ], "shipping_lines": [ { "id": 3866102288, "title": "Standard Shipping", "price": "10.00", "code": "Standard Shipping", "source": "shopify", "phone": null, "requested_fulfillment_service_id": null, "delivery_category": null, "carrier_identifier": null, "tax_lines": [ ] } ], "billing_address": { "first_name": "A", "address1": "Groenedijk", "phone": null, "city": "Dordrecht", "zip": "3311 DB", "province": null, "country": "Netherlands", "last_name": "Overbosch-Brunsting", "address2": "58", "company": null, "latitude": 51.8137503, "longitude": 4.680407499999999, "name": "A Overbosch-Brunsting", "country_code": "NL", "province_code": null }, "shipping_address": { "first_name": "A", "address1": "Groenedijk", "phone": null, "city": "Dordrecht", "zip": "3311 DB", "province": null, "country": "Netherlands", "last_name": "Overbosch-Brunsting", "address2": "58", "company": null, "latitude": 51.8137503, "longitude": 4.680407499999999, "name": "A Overbosch-Brunsting", "country_code": "NL", "province_code": null }, "fulfillments": [ ], "client_details": { "browser_ip": "201.202.125.58", "accept_language": "nl-NL,nl;q=0.8,en-US;q=0.6,en;q=0.4", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36", "session_hash": "11f6cc709c9ff5d80e561af058ff7f74", "browser_width": 1280, "browser_height": 699 }, "refunds": [ ], "payment_details": { "credit_card_bin": "1", "avs_result_code": null, "cvv_result_code": null, "credit_card_number": "•••• •••• •••• 1", "credit_card_company": "Bogus" }, "customer": { "id": 4992646480, "email": "info@studiorao.nl", "accepts_marketing": false, "created_at": "2017-04-05T15:09:27-04:00", "updated_at": "2017-04-25T13:08:13-04:00", "first_name": "A", "last_name": "Overbosch-Brunsting", "orders_count": 0, "state": "enabled", "total_spent": "0.00", "last_order_id": null, "note": "VAT Registration Number: NL1799.87.781.B01", "verified_email": true, "multipass_identifier": null, "tax_exempt": false, "phone": null, "tags": "", "last_order_name": null, "default_address": { "id": 5273097936, "first_name": "A", "last_name": "Overbosch-Brunsting", "company": null, "address1": "Groenedijk", "address2": "58", "city": "Dordrecht", "province": null, "country": "Netherlands", "zip": "3311 DB", "phone": null, "name": "A Overbosch-Brunsting", "province_code": null, "country_code": "NL", "country_name": "Netherlands", "default": true }}}';
$json = '{"id":4701099344,"email":"k.siva1992@gmail.com","closed_at":null,"created_at":"2017-05-31T02:51:27-04:00","updated_at":"2017-05-31T03:06:31-04:00","number":14,"note":null,"token":"990f57351840cf076207403bc5472e6a","gateway":"bogus","test":true,"total_price":"1327.62","subtotal_price":"1088.94","total_weight":0,"total_tax":"228.68","taxes_included":false,"currency":"EUR","financial_status":"paid","confirmed":true,"total_discounts":"0.00","total_line_items_price":"1088.94","cart_token":"bcefa884830c2de34c9d8009c061242f","buyer_accepts_marketing":false,"name":"#1014","referring_site":"","landing_site":"\\/admin\\/auth\\/login","cancelled_at":null,"cancel_reason":null,"total_price_usd":"1477.50","checkout_token":"5129438d61687cf45c5c310b4e9c66e2","reference":null,"user_id":null,"location_id":null,"source_identifier":null,"source_url":null,"processed_at":"2017-05-31T02:51:27-04:00","device_id":null,"phone":null,"browser_ip":null,"landing_site_ref":null,"order_number":1014,"discount_codes":[],"note_attributes":[],"payment_gateway_names":["bogus"],"processing_method":"direct","checkout_id":13745403024,"source_name":"web","fulfillment_status":null,"tax_lines":[{"title":"VAT","price":"228.68","rate":0.21}],"tags":"","contact_email":"k.siva1992@gmail.com","order_status_url":"https:\\/\\/checkout.shopify.com\\/19038531\\/checkouts\\/5129438d61687cf45c5c310b4e9c66e2\\/thank_you_token?key=8b47f2728a40bfa00620cf03ec88619c","line_items":[{"id":8768109904,"variant_id":35645859472,"title":"Horizontal Grid Profiles","quantity":1,"price":"21.44","grams":0,"sku":"","variant_title":"1 \\/ 1000","vendor":"Portapivot","fulfillment_service":"manual","product_id":8713120912,"requires_shipping":true,"taxable":true,"gift_card":false,"name":"Horizontal Grid Profiles - 1 \\/ 1000","variant_inventory_management":null,"properties":[{"name":"Height","value":"2000"},{"name":"Width","value":"1200"},{"name":"Color","value":"black"},{"name":"hingePosition","value":"1\\/3"},{"name":"referenceNumber","value":"siva_testing_2"}],"product_exists":true,"fulfillable_quantity":1,"total_discount":"0.00","fulfillment_status":null,"tax_lines":[{"title":"VAT","price":"4.50","rate":0.21}],"origin_location":{"id":3136684496,"country_code":"NL","province_code":"","name":"portatest","address1":"Pannekoekstraat 37 a","address2":"","city":"Rotterdam","zip":"3011 LC"},"destination_location":{"id":3337266384,"country_code":"NL","province_code":"","name":"Siva K","address1":"2nd Cross Street","address2":"","city":"Amsterdam","zip":"1011"}},{"id":8768109968,"variant_id":33870399184,"title":"single DG.10","quantity":1,"price":"287.50","grams":0,"sku":"","variant_title":"black","vendor":"Portapivot","fulfillment_service":"manual","product_id":8713114576,"requires_shipping":true,"taxable":true,"gift_card":false,"name":"single DG.10 - black","variant_inventory_management":null,"properties":[{"name":"Height","value":"2000"},{"name":"Width","value":"1200"},{"name":"Color","value":"black"},{"name":"hingePosition","value":"1\\/3"},{"name":"referenceNumber","value":"siva_testing_2"}],"product_exists":true,"fulfillable_quantity":1,"total_discount":"0.00","fulfillment_status":null,"tax_lines":[{"title":"VAT","price":"60.38","rate":0.21}],"origin_location":{"id":3136684496,"country_code":"NL","province_code":"","name":"portatest","address1":"Pannekoekstraat 37 a","address2":"","city":"Rotterdam","zip":"3011 LC"},"destination_location":{"id":3337266384,"country_code":"NL","province_code":"","name":"Siva K","address1":"2nd Cross Street","address2":"","city":"Amsterdam","zip":"1011"}},{"id":8768110032,"variant_id":37445404304,"title":"PORTAPIVOT 6530 XL 02","quantity":1,"price":"445.00","grams":0,"sku":"","variant_title":"2000 - 2250mm \\/ 1200 - 1299mm \\/ Basic set","vendor":"Portapivot","fulfillment_service":"manual","product_id":9368951696,"requires_shipping":true,"taxable":true,"gift_card":false,"name":"PORTAPIVOT 6530 XL 02 - 2000 - 2250mm \\/ 1200 - 1299mm \\/ Basic set","variant_inventory_management":null,"properties":[{"name":"Height","value":"2000"},{"name":"Width","value":"1200"},{"name":"Color","value":"black"},{"name":"hingePosition","value":"1\\/3"},{"name":"referenceNumber","value":"siva_testing_2"}],"product_exists":true,"fulfillable_quantity":1,"total_discount":"0.00","fulfillment_status":null,"tax_lines":[{"title":"VAT","price":"93.45","rate":0.21}],"origin_location":{"id":3136684496,"country_code":"NL","province_code":"","name":"portatest","address1":"Pannekoekstraat 37 a","address2":"","city":"Rotterdam","zip":"3011 LC"},"destination_location":{"id":3337266384,"country_code":"NL","province_code":"","name":"Siva K","address1":"2nd Cross Street","address2":"","city":"Amsterdam","zip":"1011"}},{"id":8768110096,"variant_id":33870656016,"title":"PORTAPIVOT GLASS","quantity":1,"price":"335.00","grams":0,"sku":"","variant_title":"2000 - 2250mm \\/ 700 - 799mm \\/ basic set","vendor":"Portapivot","fulfillment_service":"manual","product_id":8713138512,"requires_shipping":true,"taxable":true,"gift_card":false,"name":"PORTAPIVOT GLASS - 2000 - 2250mm \\/ 700 - 799mm \\/ basic set","variant_inventory_management":null,"properties":[{"name":"Color","value":"black"},{"name":"Height","value":"2000"},{"name":"Width","value":"700"},{"name":"referenceNumber","value":"siva_testing_1"}],"product_exists":true,"fulfillable_quantity":1,"total_discount":"0.00","fulfillment_status":null,"tax_lines":[{"title":"VAT","price":"70.35","rate":0.21}],"origin_location":{"id":3136684496,"country_code":"NL","province_code":"","name":"portatest","address1":"Pannekoekstraat 37 a","address2":"","city":"Rotterdam","zip":"3011 LC"},"destination_location":{"id":3337266384,"country_code":"NL","province_code":"","name":"Siva K","address1":"2nd Cross Street","address2":"","city":"Amsterdam","zip":"1011"}}],"shipping_lines":[{"id":3959802704,"title":"Standard Shipping","price":"10.00","code":"Standard Shipping","source":"shopify","phone":null,"requested_fulfillment_service_id":null,"delivery_category":null,"carrier_identifier":null,"tax_lines":[]}],"billing_address":{"first_name":"Siva","address1":"2nd Cross Street","phone":null,"city":"Amsterdam","zip":"1011","province":null,"country":"Netherlands","last_name":"K","address2":"","company":null,"latitude":52.3729762,"longitude":4.9039565,"name":"Siva K","country_code":"NL","province_code":null},"shipping_address":{"first_name":"Siva","address1":"2nd Cross Street","phone":null,"city":"Amsterdam","zip":"1011","province":null,"country":"Netherlands","last_name":"K","address2":"","company":null,"latitude":52.3729762,"longitude":4.9039565,"name":"Siva K","country_code":"NL","province_code":null},"fulfillments":[],"client_details":{"browser_ip":"122.164.184.169","accept_language":"en-US,en;q=0.8","user_agent":"Mozilla\\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\\/537.36 (KHTML, like Gecko) Chrome\\/58.0.3029.110 Safari\\/537.36","session_hash":null,"browser_width":1920,"browser_height":974},"refunds":[],"payment_details":{"credit_card_bin":"1","avs_result_code":null,"cvv_result_code":null,"credit_card_number":"•••• •••• •••• 1","credit_card_company":"Bogus"},"customer":{"id":5220038480,"email":"k.siva1992@gmail.com","accepts_marketing":false,"created_at":"2017-05-30T04:34:13-04:00","updated_at":"2017-05-31T02:51:27-04:00","first_name":"Siva","last_name":"K","orders_count":0,"state":"enabled","total_spent":"0.00","last_order_id":null,"note":"","verified_email":true,"multipass_identifier":null,"tax_exempt":false,"phone":null,"tags":"","last_order_name":null,"default_address":{"id":5529707344,"first_name":"Siva","last_name":"K","company":null,"address1":"2nd Cross Street","address2":"","city":"Amsterdam","province":null,"country":"Netherlands","zip":"1011","phone":null,"name":"Siva K","province_code":null,"country_code":"NL","country_name":"Netherlands","default":true}}}';
$json = iconv('UTF-8', 'UTF-8//IGNORE', utf8_encode($json));
//$json = mb_convert_encoding($json, "UTF-8", "auto");
$json = file_get_contents("latest_json.json");
$json_object = json_decode($json);

echo("<pre>");

$line_items = $json_object->line_items;
$main_products = array("PORTAPIVOT 5045", "PORTAPIVOT 5045 XL", "PORTAPIVOT 6530", "PORTAPIVOT 6530 XL", "PORTAPIVOT GLASS", "PORTAPIVOT GLASS XL", "PORTAPIVOT 6530 XL 02");
$json_object->id_order = $json_object->order_number . ".2017";
$json_object->id_wuyts = "KL000619";
$last_item = '';
$retrived_properties = array();
$line_items_array = array();
$total_price = 0;

foreach($json_object->line_items as $line_item_key => $line_item) {
	
		if(in_array($line_item->title, $main_products)) {
			
			if(!empty($retrived_properties)) {
				$line_item->properties = array_merge($line_item->properties, $retrived_properties);
			}
			
			$line_item->uniek_product_id = $json_object->order_number . "." . $line_item->id;
			$line_item->door_price = $total_price + $line_item->price;
			$total_price = 0;
			$retrived_properties = array();
			array_push($line_items_array, $line_item);
			$last_item = '';
		
			continue;
		}
		
		if($line_item->sku != '') {
			
			$line_item->uniek_product_id = $json_object->order_number . "." . $line_item->id;
			$line_item->door_price = $total_price + $line_item->price;
			$total_price = 0;
			$retrived_properties = array();
			$total_price = 0;
			array_push($line_items_array, $line_item);
			$last_item = '';

			continue;
		}
		
				
		if($line_item->title == 'Vertical Grid Profiles') {
			if($line_item->variant_title == 0 || $line_item->variant_title == '') {
				$object = (object) [ 'name' => 'verticalGrid', 'value' => 0 ];
			} else {
				$object = (object) [ 'name' => 'verticalGrid', 'value' => strstr($line_item->variant_title, ' / ', true) ];
			}
			array_push($retrived_properties, $object);
			//print_r($object);
		} else if($line_item->title == 'Horizontal Grid Profiles') {
			if($line_item->variant_title == 0 || $line_item->variant_title == '') {
				$object = (object) [ 'name' => 'horizontalGrid', 'value' => 0 ];
			} else {
				$object = (object) [ 'name' => 'horizontalGrid', 'value' => strstr($line_item->variant_title, ' / ', true) ];
			}
			array_push($retrived_properties, $object);
			//print_r($object);
		} else if(endsWith($line_item->variant_title, 'set')) {
			if(get_string_between($line_item->variant_title, '/ ', " set") != '') {
				$object = (object) [ 'name' => 'stealthpivot', 'value' => get_string_between($line_item->variant_title, '/ ', " set") ];
			} else {
				$object = (object) [ 'name' => 'stealthpivot', 'value' => $line_item->variant_title ];
			}
			array_push($retrived_properties, $object);
			//print_r($object);
		} else {
			if(startsWith($line_item->title, "single")) {
				$handle_value = substr($line_item->title, strpos($line_item->title, " ") + 1);
				$object = (object) [ 'name' => 'handles', 'value' => $handle_value, 'amount' => "1" ];
			} else if(startsWith($line_item->title, "double")) {
				$handle_value = substr($line_item->title, strpos($line_item->title, " ") + 1);
				$object = (object) [ 'name' => 'handles', 'value' => $handle_value, 'amount' => "2" ];
			} else {
				$object = (object) [ 'name' => 'handles', 'value' => $line_item->title ];
			}
			array_push($retrived_properties, $object);
		}
		
		$last_item = $line_item;
		$total_price = $total_price + $line_item->price;
		
	
}


if(!empty($retrived_properties)) {
	$last_item->properties = array_merge($last_item->properties, $retrived_properties);
	$last_item->uniek_product_id = $json_object->order_number . "." . $last_item->id;
	$last_item->door_price = $total_price + $last_item->price;
	$total_price = 0;
	$retrived_properties = array();
	array_push($line_items_array, $last_item);
	$last_item = '';
}

function startsWith($haystack, $needle)
{
     $length = strlen($needle);
     return (substr($haystack, 0, $length) === $needle);
}

function endsWith($haystack, $needle)
{
    $length = strlen($needle);
    if ($length == 0) {
        return true;
    }

    return (substr($haystack, -$length) === $needle);
}

function get_string_between($string, $start, $end){
    $string = ' ' . $string;
    $ini = strpos($string, $start);
    $ini = strpos($string, $start, $ini + strlen($start));	//gets the second occurence of the start value
    if ($ini == 0) return '';
    $ini += strlen($start);
    $len = strpos($string, $end, $ini) - $ini;
    return substr($string, $ini, $len);
}

//$json_object->line_items = array();
$json_object->line_items = $line_items_array;
//print_r($json_object);

//print_r(json_encode($json_object));

//print_r($retrived_properties);

if(isset($_GET['data']) && $_GET['data']=="json") {
	print_r(json_encode((object) array('orders' => $json_object)));
	//print_r(json_encode($json_object));
} else {

require_once 'XML/Serializer.php';

$data = $json_object;

$options = array(
       XML_SERIALIZER_OPTION_INDENT      => "\t",     // indent with tabs
       XML_SERIALIZER_OPTION_LINEBREAKS  => "\n",     // use UNIX line breaks
       XML_SERIALIZER_OPTION_ROOT_NAME   => 'orders',// root tag
       XML_SERIALIZER_OPTION_DEFAULT_TAG => 'element'    // tag for values
                                                      // with numeric keys
    );

$Serializer = new XML_Serializer($options);
$status = $Serializer->serialize($data);

if (PEAR::isError($status)) die($status->getMessage());

echo '<pre>';
echo htmlspecialchars($Serializer->getSerializedData());
echo '</pre>';

}